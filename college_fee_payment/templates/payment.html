<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Payment – PBR VITS</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- Styles moved to style.css -->
    <script>
        const REF_ID = "{{ ref }}";

        function showDetails(mode) {
            document.getElementById("paymentDetails").classList.remove("hidden");
            document.getElementById("modeDisplay").innerText = mode;
            document.getElementById("modeInput").value = mode;

            const qrContainer = document.getElementById("qrCodeContainer");
            const nextBtn = document.getElementById("nextBtn");
            const msgElement = document.getElementById("message");

            let msg = "";

            // Reset UI state
            qrContainer.style.display = "none";

            // Enable button
            nextBtn.disabled = false;
            nextBtn.innerText = "NEXT";

            if (mode === "SBI Net Banking") {
                msg = "Redirecting to SBI Net Banking...";
            } else if (mode === "Credit Card") {
                msg = "Redirecting to Secure Gateway...";
            } else if (mode === "UPI") {
                msg = "Scan the QR code to pay instantly.";
                qrContainer.style.display = "inline-block";
            } else if (mode === "Branch") {
                msg = "Visit branch with reference number.";
            }

            msgElement.innerText = msg;
        }

        function submitPayment() {
            document.getElementById("paymentForm").submit();
        }
    </script>
</head>

<body>
    {% include 'spinner.html' %}

    <div class="glass-card" style="width: 1000px; max-width: 95%;">

        <!-- WARNING -->
        <div
            style="background: #fff9c4; color: #333; padding: 10px; margin-bottom: 20px; font-size: 14px; text-align: center; border-radius: 5px;">
            <b>This page will expire in 01.00 minute, please complete the payment in time to avoid timeout error.</b>
        </div>

        <!-- PAYMENT OPTIONS -->
        <h2 style="text-align: center; margin-bottom: 30px;">Select Payment Mode</h2>

        <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; margin-bottom: 40px;">
            <div class="payment-box" onclick="showDetails('SBI Net Banking')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/c/cc/SBI-logo.svg" alt="SBI">
                <p>SBI Net Banking</p>
                <button class="click-btn">Select</button>
            </div>

            <div class="payment-box" onclick="showDetails('Credit Card')">
                <!-- Using text or generic icon if img fails, but keeping img tag -->
                <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Card">
                <p>Credit Card</p>
                <button class="click-btn">Select</button>
            </div>

            <div class="payment-box" onclick="showDetails('UPI')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/UPI-Logo-vector.svg" alt="UPI">
                <p>UPI / QR</p>
                <button class="click-btn">Select</button>
            </div>

            <div class="payment-box" onclick="showDetails('Branch')">
                <img src="https://cdn-icons-png.flaticon.com/512/2830/2830284.png" alt="Branch">
                <p>Branch</p>
                <button class="click-btn">Select</button>
            </div>
        </div>

        <!-- PAYMENT DETAILS -->
        <div id="paymentDetails" class="hidden"
            style="max-width: 500px; margin: auto; animation: slideUp 0.5s ease-out;">
            <h3 style="border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 10px; margin-bottom: 20px;">
                Payment Summary</h3>

            <div class="summary-row">
                <span>Fee Type</span>
                <span id="feeType" style="font-weight: 600;">COLLEGE FEE</span>
            </div>

            <div class="summary-row">
                <span>Amount</span>
                <span style="font-weight: 600; font-size: 18px;">₹ <span id="amount">{{ amount }}</span></span>
            </div>

            <div class="summary-row">
                <span>Payment Mode</span>
                <span id="modeDisplay" style="font-weight: 600;"></span>
            </div>

            <p id="message" style="margin: 20px 0; font-size: 14px; text-align: center; color: #ffeb3b;"></p>

            <div style="text-align: center;">
                <div id="qrCodeContainer" class="hidden">
                    <p style="font-weight: bold; color: #000;">Scan to Pay</p>
                    <img src="{{ url_for('static', filename='qr_code.jpg') }}" alt="QR Code" style="width: 180px;">
                </div>
            </div>

            <form id="paymentForm" action="{{ url_for('payment') }}" method="POST" style="margin-top: 20px;">
                <input type="hidden" name="mode" id="modeInput">
                <button type="button" id="nextBtn" class="btn" onclick="submitPayment()">NEXT</button>
            </form>
        </div>

    </div>

</body>

</html>